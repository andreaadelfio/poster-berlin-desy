{% extends "poster.jinja2" %}

{### Header ###}

{% set poster_title = "Anomaly Detection with Machine Learning in Time Series Data from the Fermi Anti-Coincidence Detector" %}
{% set poster_subtitle = "" %}
{% set venue_long = "Berlin - DESY 2025" %}
{% set venue_short = "2025-02-26 - 2025-02-28" %}
{% set webpage_title = poster_title + " (" + venue_long + " poster)" %}
{% set project_url = "" %}
{% set venue_url = "https://indico.desy.de/event/46887/" %}
{% set contact = "andrea.adelfio@pg.infn.it" %}

{% set pub_datetime_iso = "2025-02-26" %}
{% set pub_date = "February 26, 2025" %}

{% block custom_head %}
  <style type="text/css">
    html { font-size: 0.95rem }
  </style>
{% endblock %}

{% block badges %}
  {# --------------- #}
  {# For HTML poster #}
  {# --------------- #}
  <a href="https://indico.desy.de/event/46887/"><img alt="indico event" src="https://img.shields.io/badge/indico-event-black?style=flat&logoColor=white"></a>
  <a href="https://indico.desy.de/event/46887/contributions/180939/"><img alt="indico contribution" src="https://img.shields.io/badge/indico-contribution-c48e48?style=flat&logoColor=white"></a>
  <a href="https://indico.desy.de/event/46887/contributions/180939//attachments/126603/186941/Anomaly%20Detection%20with%20Machine%20Learning%20in%20Time%20Series%20Data%20from%20the%20Fermi%20Anti-Coincidence%20Detector%20(09_10_2024%20-%2011_10_2024%20poster).pdf"><img alt="poster PDF" src="https://img.shields.io/badge/PDF-poster-EC1C24?style=flat&logo=Adobe%20Acrobat%20Reader&logoColor=white"></a>
  <a href="https://github.com/andreaadelfio/poster-berlin-desy"><img alt="poster on github" src="https://img.shields.io/badge/github-poster-red"></a>
  <a href="https://github.com/andreaadelfio/ACDAnomalies"><img alt="code on github" src="https://img.shields.io/badge/github-code-white"></a>
{% endblock %}

{% block authors %}
  <span class="medium">
    <a property="author"><strong>Andrea Adelfio</strong><sup>1,2</sup></a>,
    <a property="author">Sara Cutini<sup>1,2</sup></a>,
    <a property="author">Stefano Germani<sup>3,2</sup></a>,
    <a property="author">Francesco Longo<sup>4,2</sup></a>,
    <a property="author">Simone Maldera<sup>5</sup></a>,
    <a property="author">Riccardo Crupi<sup>6,2</sup></a>
  </span>
{% endblock %}

{% block affiliations %}
  <span class="normal">
    <sup>1</sup><a property="sourceOrganization">INFN-Perugia</a>,
    <sup>2</sup><a property="sourceOrganization">ICSC</a>,
    <sup>3</sup><a property="sourceOrganization">University of Perugia</a>,
    <sup>4</sup><a property="sourceOrganization">INFN-Trieste</a>,
    <sup>5</sup><a property="sourceOrganization">INFN-Torino</a>,
    <sup>6</sup><a property="sourceOrganization">University of Udine</a>,
  </span>
{% endblock %}

{# Project logos shown on the left side #}
{% block project_logos %}
  {# --------------- #}
  {# For HTML poster #}
  {# --------------- #}
  {# <div style="width: 24rem">
    <a href="https://next-generation-eu.europa.eu"><img style="height: 2.5rem; padding: 0.55rem" src="img/logos/nextgeneu-white-logo.png" alt="NextGenEU logo"></a>
    <a href="https://www.mur.gov.it"><img style="height: 2.5rem; padding: 0.55rem" src="img/logos/mur-white-logo.png" alt="MUR logo"></a>
    <a href="https://www.italiadomani.gov.it"><img style="height: 2.5rem; padding: 0.55rem" src="img/logos/pnrr-white-logo.png" alt="PNRR logo"></a>
    <a href="https://www.supercomputing-icsc.it/en"><img style="height: 2.5rem; padding: 0.55rem" src="img/logos/icsc-white-logo-nobkg.png" alt="ICSC logo"></a>
  </div> #}
  {# -------------- #}
  {# For PDF poster #}
  {# -------------- #}
  <div style="width: 24rem">
    <a href="https://next-generation-eu.europa.eu"><img style="height: 2.5rem; padding-right: 0.55rem; padding-bottom: 0.5rem" src="img/logos/nextgeneu-white-logo.png" alt="NextGenEU logo"></a>
    <a href="https://www.mur.gov.it"><img style="height: 2.5rem; padding-left: 0.55rem; padding-bottom: 0.5rem" src="img/logos/mur-white-logo.png" alt="MUR logo"></a>
    <a href="https://www.italiadomani.gov.it"><img style="height: 2.5rem; padding-right: 1.0rem; padding-top: 0.5rem" src="img/logos/pnrr-white-logo.png" alt="PNRR logo"></a>
    <a href="https://www.supercomputing-icsc.it/en"><img style="height: 2.5rem; padding-left: 1.0rem; padding-top: 0.5rem" src="img/logos/icsc-white-logo-nobkg.png" alt="ICSC logo"></a>
  </div>
{% endblock %}

{# Extra logos shown on the right side #}
{% block logos %}
  {# --------------- #}
  {# For HTML poster #}
  {# --------------- #}
  {# <a href="{{ venue_url }}"><img style="padding: 0.55rem" src="img/logos/fermi-logo.png" alt="Fermi logo"></a> #}
  {# -------------- #}
  {# For PDF poster #}
  {# -------------- #}
  <a href="{{ venue_url }}"><img style="padding-right: 2.5rem" src="img/logos/fermi-logo.png" alt="Fermi logo"></a>
{% endblock %}

{### Footer ###}

{# Disclaimer shown on the left side #}
{% block disclaimer %}
  {# on behalf of the LHCb Simulation Project #}
  <strong>ICSC</strong> Italian Research Center on High-Performance Computing, Big Data and Quantum Computing
{% endblock %}

{# Contact information shown on the middle side #}
{% block contact_info %}
  {# contact: <a class="monospace">{{ contact }}</a> #}
  <em>Missione 4 • Istruzione e Ricerca</em>
{% endblock %}

{# General information shown on the right side #}
{% block general_info %}
  October 2024, Bari (Italy)
{% endblock %}

{### Contents ###}

{% block contents %}
  {# Abstract #}
  <article>
    <header><h3>Abstract</h3></header>
    <p>
      Multimessenger astrophysics relies on multiple observational data channels, necessitating efficient methods for analyzing events of astrophysical origin. With the continuous increase in both volume and complexity of data from modern observatories, advanced Machine Learning techniques have become very useful for identifying and classifying signals effectively.
    </p>
    <p>
      My project aim at developing a framework to analyze <strong>time series data</strong> using Machine Learning techniques. The scientific use case that will be presented involves the analysis of the temporal data from the Anti-Coincidence Detector (ACD) onboard the Fermi Gamma-ray Space Telescope. The primary objective is to enhance the detection of high-energy transient events, such as Gamma-Ray Bursts (GRBs), and other astrophysical signals. An ensamble of Neural Networks models may be employed to model and predict the temporal structure of the ACD background data. The network's predictions are used as a baseline for implementing a triggering algorithm, designed for anomaly detection. By identifying significant deviations from the predicted background, the system effectively flags potential astrophysical transients in the ACD time series data.
    </p>
    <p>
      In addressing challenges such as noise variability in the data, this work explores advanced approaches to refine anomaly detection thresholds, by characterizing the noise amplitude. Bayesian Neural Networks (BNNs) can be used to output uncertainties on the background prediction to dynamically adapt thresholds, offering a robust alternative to traditional fixed-threshold methods.
    </p>
    <p>
      The application of this framework to transients detection demonstrates its applicability across various datasets and observatories in multimessenger astrophysics.
    </p>
  </article>

  {# 1. Motivation: What is The Anti-Coincidence Detector? #}
  <article>
    <header><h3>1. Motivation: What is The Anti-Coincidence Detector?</h3></header>
    <p>
      This work presents a versatile and flexible <strong>Machine Learning-based software</strong> designed to
      address two challenges in the analysis of time series data: 
      <ul>
        <li><strong>modeling the temporal behaviour</strong>
        within time series datasets to estimate the evolution of time series;</li>
        <li><strong>identifying anomalies</strong> within those time series.</li>
      </ul>
    </p>
    <p>
      The <strong>Anti-Coincidence Detector</strong> (ACD) is a system on board of Fermi used to reject background signals such as charged-particles from the Large Area Telescope signal. 
    </p>
    <figure>
      <img style="width: 70%" src="img/pictures/ACD_from_above.jpg" alt="ACD_from_above">
    </figure>
    <p>
      The ACD is composed of 89 plastic scintillator tiles distributed in the five faces of the ACD. These tiles detect particles and photons and the signal in each face looks like this:
    </p>
    <figure>
      <img style="width: 100%" src="img/pictures/Outputs_1.png" alt="outputs 24 signal">
    </figure>
    <figure>
      <img style="width: 100%" src="img/pictures/Outputs_.png" alt="full/Outputs_">
    </figure>
  </article>

  {# 2. Dataset #}
  <article>
    <header><h3>2. Dataset</h3></header>
    <p>
      The dataset used for the training and testing of the software is composed of the time series of the five signals in the ACD and a set of input features:
      <ul>
        <li>the parameters in the <strong>weekly Spacecraft files</strong> (FT2) from the Fermi Collaboration;</li>
        <figure>
          <img style="width: 100%" src="img/pictures/inputs_ft2.png" alt="full/inputs_ft2 schemes">
        </figure>
        <li>the <strong>Solar Activity</strong> retrieved from the Geostationary Operational Environmental Satellite (GOES) X-Ray Sensor (XRS);</li>
        <figure>
          <img style="width: 100%" src="img/pictures/flares.png" alt="full/flares schemes">
        </figure>
        <li>the signals of the five faces in the ACD.</li>
      </ul>
    </p>
  </article>

  {# 3. Background Prediction with Bayesian Neural Networks #}
  <article>
    <header><h3>3. Background Prediction with Bayesian Neural Networks</h3></header>
    <p>
      The software was developed starting from the data of the ACD as a playground.
    </p>
    <p>
      The software implements a multioutput <strong>Bayesian Neural Network</strong> (BNN) to model the temporal behaviour of the time series. Unlike traditional feed-forward neural networks, the BNN not only provides point estimates but also quantifies the uncertainty associated with each prediction.
      In the context of the ACD, the training of the Bayesian Neural Network is performed on a dataset where the ACD signals serve as the labeled outputs and a set of input parameters characterize each sample.
    </p>
    <hr/>
    <figure>
      <img style="width: 100%" src="img/schemes/inputs_nn_output.png" alt="full/inputs_nn_output schemes">
    </figure>
    <p>
      The BNN is trained using a likelihood-based loss function derived from the <strong>Gaussian Negative Log Likelihood</strong> (NLL). This loss function is particularly suitable when the data is assumed to be Gaussian, as it penalizes deviations based on both the error in the prediction and the predicted uncertainty.
    </p>
    <p>
      The Gaussian NLL is defined as:
    </p>
    \[
    \mathcal{L}_{\textit{NLL}} = \frac{1}{N}\sum_{i=1}^N \left( \frac{1}{2}\log(\sigma_i^2) + \frac{(y_i - \mu_i)^2}{2\sigma_i^2} \right),
    \]
    <p>
      where \(N\) is the number of samples, \(y_i\) is the true value (ground truth) of the signal for the \(i\)-th sample, \(\mu_i\) is the predicted mean, and \(\sigma_i^2\) is the predicted variance, representing the uncertainty in the prediction.
      For a multioutput BNN with an estimator function \(f_j\) for the \(j\)-th output, the loss can be written as:
    </p>
    \[
    \mathcal{L}_{\textit{NLL},j} = \frac{1}{N}\sum_{i=1}^N \left( \frac{1}{2}\log(\sigma_{j,i}^2) + \frac{(y_{j,i} - f_j(\mathbf{x}_i))^2}{2\sigma_{j,i}^2} \right),
    \]
    <p>
      where \(\mathbf{x}_i\) is the input feature vector for sample \(i\), \(j\) indexes the \(M\) outputs (the 5 signals in the ACD), and \(f_j(\mathbf{x}_i)\) denotes the estimated mean for the \(j\)-th output, with an associated uncertainty \(\sigma_{j,i}^2\).
      The overall loss is then computed by averaging over all outputs and samples:
    </p>
    \[
    \mathcal{L}_{\textit{NLL}}=\frac{1}{M}\sum_{j=1}^M \mathcal{L}_{\textit{NLL},j} =\]

    \[ =\frac{1}{M}\sum_{j=1}^M \frac{1}{N}\sum_{i=1}^N \left( \frac{1}{2}\log(\sigma_{j,i}^2) + \frac{(y_{j,i} - f_j(\mathbf{x}_i))^2}{2\sigma_{j,i}^2} \right).
    \]
    <p>
      The Bayesian Neural Network is trained using the <strong>Adam</strong> optimizer, a stochastic gradient descent method based on adaptive estimation. In addition, a learning rate scheduler is applied to reduce the learning rate when the loss function ceases to improve, ensuring robust convergence during training.
    </p>
  </article>



  {# 4. Results of the NN #}
  <article>
    <header><h3>4. Results of the NN</h3></header>
    <p>
      The FFNN was trained on three periods of two months between January 2024 and December 2024, and then tested on different periods with known solar flare events.
    </p>
    <p>
      The figure here shown represents the prediction of the BNN for the signal in the Xpos face of the ACD, during a period in which the solar activity was particularly high. The prediction has an associated uncertainty, which is used to set the threshold for the triggering algorithm.
      <figure>
        <img style="width: 80%" src="img/pictures/Xpos_.png" alt="">
      </figure>
    </p>
  </article>

  {# 5. Identification of anomalies: Gaussian FOCuS and Z-Score#}
  <article>
    <header><h3>5. Identification of anomalies: Gaussian FOCuS and Z-Score</h3></header>
    <p>
      The software implements a triggering algorithm based on the <strong>Gaussian FOCuS</strong> method to identify anomalies in the time series 
      with a Gaussian distribution.
    </p>
    <p>
      The FOCuS (Functional Online CUSUM) algorithm is equivalent to running methods of moving windows for all possible sizes, so that duration of the anomaly is not a parameter of the algorithm, but rather assessed by the algorithm itself. The standard CUSUM statistic uses the partial sum of score statistics to time n.
    </p>
    <p>
      The algorithm takes each true signal of the ACD and the prediction of its background and calculates the statistic for each signal. When the statistic is above a certain threshold, the algorithm triggers an event for the face. Successive events are merged if they are close in time (180 seconds).
      When more then one face triggers an event, the algorithm merges the triggers to create a single anomalous event.
    </p>
    <p>
      Another method used to identify anomalies is the <strong>Z-Score</strong> method. The Z-Score is calculated as the difference between the true signal and the predicted signal divided by the uncertainty of the prediction. The Z-Score is then compared to a threshold to identify anomalies.
    </p>
    <p>
      Both these methods are used to identify anomalies and to compare them to known events in the Fermi GBM Trigger Catalog.
    </p>
  </article>

  {# 6. Results of the Triggering Algorithm #}
  <article>
    <header><h3>6. Results of the Triggering Algorithm</h3></header>
    <p>
      Some of the events identified by the triggering algorithm are shown in the following figures.
    </p>
    <figure>
      <img style="width: 49%" src="img/pictures/2024-01-31 16:16:54_Xpos_Yneg.png" alt="pictures/2024-01-31 16:16:54_Xpos_Yneg.png">
      <img style="width: 49%" src="img/pictures/2024-03-10 12:08:44_top_Xpos.png" alt="pictures/2024-03-10 12:08:44_top_Xpos.png">
      <figcaption>
        <small>
          Left: a TGF	(Terrestrial Gamma-Ray Flash) event (as described in the <a href="https://heasarc.gsfc.nasa.gov/cgi-bin/W3Browse/w3hdprods.pl?files=Preview&Coordinates=Equatorial&Equinox=2000&CheckSize=1&showgifs=1&Target=heasarc%5Ffermigtrig%7C%7C%7C%5F%5Frow%3D1674%7C%7C&popupFrom=&querytime=1740069805">Fermi GBM Trigger Catalog</a>) .
          Right: presumibly a LOCLPART event during a solar flare event (as described in the <a href="https://heasarc.gsfc.nasa.gov/db-perl/W3Browse/w3hdprods.pl?files=P&Target=heasarc%5Ffermigtrig%7C%7C%7C%5F%5Frow%3D4716%7C%7C&Coordinates=Equatorial&Equinox=2000">Fermi GBM Trigger Catalog</a>) .
        </small>
      </figcaption>
    </figure>
  </article>

  {# 7. Conclusions and outlook #}
  <article>
    <header><h3>7. Conclusions and outlook</h3></header>
    <p>
      The development of <strong><span class="monospace">ACDAnomalies</span></strong> is ongoing to offer a versatile and flexible <strong>tool
      for the anomaly detection in time series data</strong>.
    </p>
    <p>
      <strong>Bayesian NN-based models</strong> can be used to describe complex dependencies, such as the ones that characterize the environment in which the Fermi satellite is immersed along its orbit. Work is still required to assess the performance of the neural network in big datasets and in different conditions (e.g. periods in which the solar activity is particularly high).
    </p>
    <p>
      The triggering algorithm is an important part of the software, and its efficiency is under assessment.
    </p>
    <p>
      Future development of <strong><span class="monospace">ACDAnomalies</span></strong> aims to support both integration within the Fermi software stack and its 
      use as a <strong>stand-alone</strong> package.
    </p>
  </article>

  {# Acknowledgements #}
  <article>
    <header><h3>Acknowledgements</h3></header>
    <p>
      The work presented in this contribution is performed in the framework of Spoke 0 and Spoke 3 of the ICSC 
      project - <em>Centro Nazionale di Ricerca in High Performance Computing, Big Data and Quantum Computing</em>, 
      funded by the NextGenerationEU European initiative through the Italian Ministry of University and 
      Research, PNRR Mission 4, Component 2: Investment 1.4, Project code CN00000013 - CUP I53C21000340006.
    </p>
  </article>

  {# References #}
  <article>
    <header><h3>References</h3></header>
    <small>
      <ol>
        <li>Atwood et al., <em>THE LARGE AREA TELESCOPE ON THE FERMI GAMMA-RAY SPACE TELESCOPE MISSION​</em>, The Astrophysical Journal, 2009</li>
        <li>Gaetano Romano et al., <em>Fast Online Changepoint Detection via Functional Pruning CUSUM statistics</em>, Journal of Machine Learning Research, 2023</li>
        <li>Crupi, R., Dilillo, G., Bissaldi, E. et al., <em>Searching for long faint astronomical high energy transients: a data driven approach​</em>, Exp Astron 56, 421–476, 2023</li>
      </ol>
    </small>
  </article>
{% endblock %}
